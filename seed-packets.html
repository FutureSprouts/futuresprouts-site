<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Seed Packets | FutureSprouts Services</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Request seed packets and brochures." />
  <link rel="stylesheet" href="style.css" />
  <script src="config.js"></script>
</head>
<body>

  <!-- Injected header (from script.js) -->
  <div id="siteHeader"></div>

  <div class="container mobile-menu">
    <a href="about.html">About</a>
    <a href="programs.html">Programs</a>
    <a href="services.html">Services</a>
    <a href="events.html">Events</a>
    <a href="impact.html">Impact</a>
    <a href="get-involved.html">Get Involved</a>
    <a href="contact.html">Contact</a>
    <a href="donate.html" class="donate-btn">Donate</a>

    <a href="cart.html" class="cart-link mobile-cart-link" aria-label="View cart">
      <span class="cart-icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" width="18" height="18" role="img" focusable="false">
          <path d="M6.5 6.5h14l-1.2 7.2a2 2 0 0 1-2 1.7H9.1a2 2 0 0 1-2-1.6L5.2 3.8H2.8"
            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <circle cx="9.5" cy="20" r="1.4" fill="currentColor"/>
          <circle cx="17.5" cy="20" r="1.4" fill="currentColor"/>
        </svg>
      </span>
      <span style="font-weight:800;">Cart</span>
      <span class="cart-badge" id="cartBadgeMobile">0</span>
    </a>
  </div>

  <section class="section">
    <div class="container">
      <div class="kicker reveal">Services • Seed Packets</div>
      <h2 class="reveal">Choose seed types and quantities.</h2>
      <p class="reveal">For each seed type, select how many brochures and seed packets you want, then add to cart.</p>

      <!-- FILTER TAGS -->
      <div class="tags reveal" id="seedFilters" style="margin-top:14px;">
        <button class="tag active" type="button" data-filter="all">All</button>
        <button class="tag" type="button" data-filter="fruit">Fruits</button>
        <button class="tag" type="button" data-filter="vegetable">Vegetables</button>
        <button class="tag" type="button" data-filter="beginner">Beginner</button>
        <button class="tag" type="button" data-filter="pollinator">Pollinator</button>
        <button class="tag" type="button" data-filter="summer">Summer</button>
        <button class="tag" type="button" data-filter="fall">Fall</button>
        <button class="tag" type="button" data-filter="pack">Packs</button>
      </div>
      <div class="small reveal" id="seedFilterCount" style="margin-top:8px;"></div>

      <div class="grid cols-3" id="seedGrid">

        <!-- TOMATO -->
        <div class="card reveal seed-card" id="cardTomato" data-kind="seed" data-tags="fruit vegetable summer beginner">
          <img class="shop-img" src="https://images.unsplash.com/photo-1567306301408-9b74779a11af?auto=format&fit=crop&w=1600&q=80" alt="Tomato seed package">
          <div class="shop-body">
            <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
              <div class="pill">Seed Package</div>
              <span class="badge ok" id="badgeTomato">Available</span>
            </div>

            <h3 style="margin-top:10px;">Tomato Package</h3>
            <p class="small" id="descTomato" data-base="Includes tomato seed packets + basic planting guide.">
              Includes tomato seed packets + basic planting guide.
            </p>

            <div class="divider"></div>

            <div class="qty-row">
              <div>
                <strong>Brochures</strong>
                <div class="small">Info handouts</div>
              </div>
              <div class="qty">
                <button type="button" data-broch-dec="tomato">−</button>
                <span id="tomatoBroch">0</span>
                <button type="button" data-broch-inc="tomato">+</button>
              </div>
            </div>

            <div class="qty-row">
              <div>
                <strong>Seed packets</strong>
                <div class="small">Tomato packets</div>
              </div>
              <div class="qty">
                <button type="button" data-pack-dec="tomato">−</button>
                <span id="tomatoPack">0</span>
                <button type="button" data-pack-inc="tomato">+</button>
              </div>
            </div>

            <div style="margin-top:14px;">
              <button class="btn primary" type="button" data-add="seed-tomato" id="addTomato">Add to cart</button>
            </div>
          </div>
        </div>

        <!-- CORN -->
        <div class="card reveal seed-card" id="cardCorn" data-kind="seed" data-tags="vegetable summer">
          <img class="shop-img" src="https://images.unsplash.com/photo-1509223197845-458d87318791?auto=format&fit=crop&w=1600&q=80" alt="Corn seed package">
          <div class="shop-body">
            <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
              <div class="pill">Seed Package</div>
              <span class="badge ok" id="badgeCorn">Available</span>
            </div>

            <h3 style="margin-top:10px;">Corn Package</h3>
            <p class="small" id="descCorn" data-base="Includes corn seed packets + simple growing instructions.">
              Includes corn seed packets + simple growing instructions.
            </p>

            <div class="divider"></div>

            <div class="qty-row">
              <div><strong>Brochures</strong><div class="small">Info handouts</div></div>
              <div class="qty">
                <button type="button" data-broch-dec="corn">−</button>
                <span id="cornBroch">0</span>
                <button type="button" data-broch-inc="corn">+</button>
              </div>
            </div>

            <div class="qty-row">
              <div><strong>Seed packets</strong><div class="small">Corn packets</div></div>
              <div class="qty">
                <button type="button" data-pack-dec="corn">−</button>
                <span id="cornPack">0</span>
                <button type="button" data-pack-inc="corn">+</button>
              </div>
            </div>

            <div style="margin-top:14px;">
              <button class="btn primary" type="button" data-add="seed-corn" id="addCorn">Add to cart</button>
            </div>
          </div>
        </div>

        <!-- MULTI -->
        <div class="card reveal seed-card" id="cardMulti" data-kind="pack" data-tags="beginner pollinator summer fall">
          <img class="shop-img" src="https://images.unsplash.com/photo-1589923188900-85dae523342b?auto=format&fit=crop&w=1600&q=80" alt="Mixed seeds">
          <div class="shop-body">
            <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
              <div class="pill">Seed Package</div>
              <span class="badge ok" id="badgeMulti">Available</span>
            </div>

            <h3 style="margin-top:10px;">Multi-Seed Package</h3>
            <p class="small" id="descMulti" data-base="Mixed seed variety (great for classrooms and starter gardens).">
              Mixed seed variety (great for classrooms and starter gardens).
            </p>

            <div class="divider"></div>

            <div class="qty-row">
              <div><strong>Brochures</strong><div class="small">Info handouts</div></div>
              <div class="qty">
                <button type="button" data-broch-dec="multi">−</button>
                <span id="multiBroch">0</span>
                <button type="button" data-broch-inc="multi">+</button>
              </div>
            </div>

            <div class="qty-row">
              <div><strong>Seed packets</strong><div class="small">Mixed packets</div></div>
              <div class="qty">
                <button type="button" data-pack-dec="multi">−</button>
                <span id="multiPack">0</span>
                <button type="button" data-pack-inc="multi">+</button>
              </div>
            </div>

            <div style="margin-top:14px;">
              <button class="btn primary" type="button" data-add="seed-multi" id="addMulti">Add to cart</button>
            </div>
          </div>
        </div>

        <!-- POLLINATOR PACK -->
        <div class="card reveal seed-card" id="cardPollinator" data-kind="pack" data-tags="pack pollinator beginner spring summer fall">
          <img class="shop-img" src="https://images.unsplash.com/photo-1466692476868-aef1dfb1e735?auto=format&fit=crop&w=1600&q=80" alt="Pollinator pack">
          <div class="shop-body">
            <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
              <div class="pill">Seed Pack</div>
              <span class="badge ok" id="badgePollinator">Available</span>
            </div>

            <h3 style="margin-top:10px;">Pollinator Pack</h3>
            <p class="small" id="descPollinator" data-base="A curated mix that supports bees & butterflies (great for school gardens).">
              A curated mix that supports bees & butterflies (great for school gardens).
            </p>

            <div class="divider"></div>

            <div class="qty-row">
              <div><strong>Brochures</strong><div class="small">Info handouts</div></div>
              <div class="qty">
                <button type="button" data-broch-dec="pollinator">−</button>
                <span id="pollinatorBroch">0</span>
                <button type="button" data-broch-inc="pollinator">+</button>
              </div>
            </div>

            <div class="qty-row">
              <div><strong>Seed packets</strong><div class="small">Pack units</div></div>
              <div class="qty">
                <button type="button" data-pack-dec="pollinator">−</button>
                <span id="pollinatorPack">0</span>
                <button type="button" data-pack-inc="pollinator">+</button>
              </div>
            </div>

            <div style="margin-top:14px;">
              <button class="btn primary" type="button" data-add="seed-pollinator-pack" id="addPollinator">Add to cart</button>
            </div>
          </div>
        </div>

        <!-- BEGINNER GARDEN PACK -->
        <div class="card reveal seed-card" id="cardBeginner" data-kind="pack" data-tags="pack beginner vegetable fruit spring summer">
          <img class="shop-img" src="https://images.unsplash.com/photo-1524594150409-7b6b4b2b3d2a?auto=format&fit=crop&w=1600&q=80" alt="Beginner garden pack">
          <div class="shop-body">
            <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
              <div class="pill">Seed Pack</div>
              <span class="badge ok" id="badgeBeginner">Available</span>
            </div>

            <h3 style="margin-top:10px;">Beginner Garden Pack</h3>
            <p class="small" id="descBeginner" data-base="Easy-to-grow basics + simple instructions (perfect first garden).">
              Easy-to-grow basics + simple instructions (perfect first garden).
            </p>

            <div class="divider"></div>

            <div class="qty-row">
              <div><strong>Brochures</strong><div class="small">Info handouts</div></div>
              <div class="qty">
                <button type="button" data-broch-dec="beginner">−</button>
                <span id="beginnerBroch">0</span>
                <button type="button" data-broch-inc="beginner">+</button>
              </div>
            </div>

            <div class="qty-row">
              <div><strong>Seed packets</strong><div class="small">Pack units</div></div>
              <div class="qty">
                <button type="button" data-pack-dec="beginner">−</button>
                <span id="beginnerPack">0</span>
                <button type="button" data-pack-inc="beginner">+</button>
              </div>
            </div>

            <div style="margin-top:14px;">
              <button class="btn primary" type="button" data-add="seed-beginner-pack" id="addBeginner">Add to cart</button>
            </div>
          </div>
        </div>

        <!-- FALL HARVEST PACK -->
        <div class="card reveal seed-card" id="cardFall" data-kind="pack" data-tags="pack fall beginner vegetable">
          <img class="shop-img" src="https://images.unsplash.com/photo-1506806732259-39c2d0268443?auto=format&fit=crop&w=1600&q=80" alt="Fall harvest pack">
          <div class="shop-body">
            <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
              <div class="pill">Seed Pack</div>
              <span class="badge ok" id="badgeFall">Available</span>
            </div>

            <h3 style="margin-top:10px;">Fall Harvest Pack</h3>
            <p class="small" id="descFall" data-base="Cool-season favorites for late-summer planting and fall harvests.">
              Cool-season favorites for late-summer planting and fall harvests.
            </p>

            <div class="divider"></div>

            <div class="qty-row">
              <div><strong>Brochures</strong><div class="small">Info handouts</div></div>
              <div class="qty">
                <button type="button" data-broch-dec="fall">−</button>
                <span id="fallBroch">0</span>
                <button type="button" data-broch-inc="fall">+</button>
              </div>
            </div>

            <div class="qty-row">
              <div><strong>Seed packets</strong><div class="small">Pack units</div></div>
              <div class="qty">
                <button type="button" data-pack-dec="fall">−</button>
                <span id="fallPack">0</span>
                <button type="button" data-pack-inc="fall">+</button>
              </div>
            </div>

            <div style="margin-top:14px;">
              <button class="btn primary" type="button" data-add="seed-fall-pack" id="addFall">Add to cart</button>
            </div>
          </div>
        </div>

      </div>

      <div class="notice reveal">
        After adding items, click the cart icon in the top-right and submit your request.
      </div>
    </div>
  </section>

  <!-- Injected footer (from script.js) -->
  <div id="siteFooter"></div>

  <!-- IMPORTANT: script.js must load BEFORE this page script -->
  <script src="script.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", () => {

      // ---------------------------
      // Filter chips (single-select)
      // ---------------------------
      (function initSeedFilters(){
        const tags = Array.from(document.querySelectorAll("#seedFilters .tag"));
        const cards = Array.from(document.querySelectorAll(".seed-card"));
        const countEl = document.getElementById("seedFilterCount");

        if (!tags.length || !cards.length) return;

        function applyFilter(filter) {
          tags.forEach(t => t.classList.toggle("active", t.dataset.filter === filter));

          let shown = 0;
          cards.forEach(card => {
            const tagList = String(card.dataset.tags || "").split(/\s+/).filter(Boolean);
            const kind = card.dataset.kind || "";

            const show =
              filter === "all" ||
              tagList.includes(filter) ||
              kind === filter;

            card.style.display = show ? "" : "none";
            if (show) shown++;
          });

          if (countEl) countEl.textContent = `Showing ${shown} of ${cards.length}`;
        }

        tags.forEach(btn => btn.addEventListener("click", () => applyFilter(btn.dataset.filter)));
        applyFilter("all");
      })();

      // ---------------------------
      // Quantity state
      // ---------------------------
      const state = {
        tomato:     { brochures: 0, packets: 0 },
        corn:       { brochures: 0, packets: 0 },
        multi:      { brochures: 0, packets: 0 },
        pollinator: { brochures: 0, packets: 0 },
        beginner:   { brochures: 0, packets: 0 },
        fall:       { brochures: 0, packets: 0 }
      };

      function clamp(n) { return Math.max(0, Math.min(200, n)); }

      function render() {
        document.getElementById("tomatoBroch").textContent = state.tomato.brochures;
        document.getElementById("tomatoPack").textContent  = state.tomato.packets;

        document.getElementById("cornBroch").textContent = state.corn.brochures;
        document.getElementById("cornPack").textContent  = state.corn.packets;

        document.getElementById("multiBroch").textContent = state.multi.brochures;
        document.getElementById("multiPack").textContent  = state.multi.packets;

        document.getElementById("pollinatorBroch").textContent = state.pollinator.brochures;
        document.getElementById("pollinatorPack").textContent  = state.pollinator.packets;

        document.getElementById("beginnerBroch").textContent = state.beginner.brochures;
        document.getElementById("beginnerPack").textContent  = state.beginner.packets;

        document.getElementById("fallBroch").textContent = state.fall.brochures;
        document.getElementById("fallPack").textContent  = state.fall.packets;
      }

      function bindQty(type) {
        document.querySelectorAll(`[data-broch-inc="${type}"]`).forEach(b => b.onclick = () => { state[type].brochures = clamp(state[type].brochures + 1); render(); });
        document.querySelectorAll(`[data-broch-dec="${type}"]`).forEach(b => b.onclick = () => { state[type].brochures = clamp(state[type].brochures - 1); render(); });
        document.querySelectorAll(`[data-pack-inc="${type}"]`).forEach(b => b.onclick = () => { state[type].packets = clamp(state[type].packets + 1); render(); });
        document.querySelectorAll(`[data-pack-dec="${type}"]`).forEach(b => b.onclick = () => { state[type].packets = clamp(state[type].packets - 1); render(); });
      }

      ["tomato", "corn", "multi", "pollinator", "beginner", "fall"].forEach(bindQty);
      render();

      function uniqueId(baseId) {
        return `${baseId}-${Date.now()}-${Math.random().toString(16).slice(2)}`;
      }

      function readItemStatus(itemKey) {
        const fallback = { label: "Available", tone: "ok", remaining: null, out: false };
        if (!window.FS_CART || typeof window.FS_CART.loadInventory !== "function") return fallback;

        const inv = window.FS_CART.loadInventory();
        const items = (inv && inv.items) || {};
        const it = items[itemKey];
        if (!it) return fallback;

        const availableFlag = (it.available !== false);
        const remaining = (typeof it.remaining === "number") ? it.remaining : null;
        const availableNow = availableFlag && (remaining == null || remaining > 0);

        if (!availableNow) return { label: "Out of stock", tone: "danger", remaining: 0, out: true };
        if (remaining != null && remaining <= 10) return { label: "Limited", tone: "warn", remaining, out: false };
        return { label: "Available", tone: "ok", remaining, out: false };
      }

      function setSeedUI(seedKey, itemKey, badgeId, descId, addBtnId, cardId) {
        const st = readItemStatus(itemKey);

        const badge = document.getElementById(badgeId);
        const desc = document.getElementById(descId);
        const addBtn = document.getElementById(addBtnId);
        const card = document.getElementById(cardId);

        if (badge) {
          badge.textContent = st.label;
          badge.classList.remove("ok","warn","danger");
          badge.classList.add(st.tone);
        }

        if (desc) {
          const base = desc.getAttribute("data-base") || desc.textContent;
          desc.setAttribute("data-base", base);
          if (st.label === "Limited" && typeof st.remaining === "number") {
            desc.textContent = `${base} • Remaining: ${st.remaining}`;
          } else {
            desc.textContent = base;
          }
        }

        const disable = st.out === true;

        document.querySelectorAll(
          `[data-broch-inc="${seedKey}"],[data-broch-dec="${seedKey}"],[data-pack-inc="${seedKey}"],[data-pack-dec="${seedKey}"]`
        ).forEach(btn => {
          btn.disabled = disable;
          btn.style.opacity = disable ? "0.55" : "";
          btn.style.cursor = disable ? "not-allowed" : "";
        });

        if (addBtn) {
          addBtn.disabled = disable;
          addBtn.style.opacity = disable ? "0.55" : "";
          addBtn.style.cursor = disable ? "not-allowed" : "";
          addBtn.textContent = disable ? "Out of stock" : "Add to cart";
        }

        if (card && disable) card.style.opacity = "0.72";

        return st;
      }

      const statusTomato     = setSeedUI("tomato","seed-tomato","badgeTomato","descTomato","addTomato","cardTomato");
      const statusCorn       = setSeedUI("corn","seed-corn","badgeCorn","descCorn","addCorn","cardCorn");
      const statusMulti      = setSeedUI("multi","seed-multi","badgeMulti","descMulti","addMulti","cardMulti");

      const statusPollinator = setSeedUI("pollinator","seed-pollinator-pack","badgePollinator","descPollinator","addPollinator","cardPollinator");
      const statusBeginner   = setSeedUI("beginner","seed-beginner-pack","badgeBeginner","descBeginner","addBeginner","cardBeginner");
      const statusFall       = setSeedUI("fall","seed-fall-pack","badgeFall","descFall","addFall","cardFall");

      document.querySelectorAll("[data-add]").forEach(btn => {
        btn.addEventListener("click", () => {
          if (!window.FS_CART || typeof window.FS_CART.cartAddOrUpdate !== "function") {
            alert("Cart system not loaded. Make sure script.js is loading without errors (check DevTools Console).");
            return;
          }

          const baseId = btn.getAttribute("data-add");
          const map = {
            "seed-tomato":          { key: "tomato",     name: "Seed Packets — Tomato",        status: statusTomato },
            "seed-corn":            { key: "corn",       name: "Seed Packets — Corn",          status: statusCorn },
            "seed-multi":           { key: "multi",      name: "Seed Packets — Multi-Seed",    status: statusMulti },

            "seed-pollinator-pack": { key: "pollinator", name: "Seed Packets — Pollinator Pack", status: statusPollinator },
            "seed-beginner-pack":   { key: "beginner",   name: "Seed Packets — Beginner Pack",   status: statusBeginner },
            "seed-fall-pack":       { key: "fall",       name: "Seed Packets — Fall Harvest Pack", status: statusFall }
          };

          const info = map[baseId];
          if (!info) {
            window.FS_CART.showModal("Error", "Unknown seed type. Please refresh the page.");
            return;
          }

          if (info.status && info.status.out) {
            window.FS_CART.showModal("Out of stock", "This item is currently unavailable. Please check back later.");
            return;
          }

          const s = state[info.key];
          if ((s.brochures + s.packets) === 0) {
            window.FS_CART.showModal("Nothing selected", "Choose at least 1 brochure or 1 seed packet before adding to cart.");
            return;
          }

          const id = uniqueId(baseId);

          window.FS_CART.cartAddOrUpdate(
            id,
            info.name,
            { brochures: s.brochures, packets: s.packets, seedType: info.key, baseId: baseId },
            1,
            null
          );

          state[info.key].brochures = 0;
          state[info.key].packets = 0;
          render();

          window.FS_CART.showModal("Added to cart", "Item added. Click the cart icon in the top-right to submit your request.");
        });
      });
    });
  </script>
</body>
</html>
